function rgb = lum2rgb( lum, roundflag )% LUM2RGB  Convert luminance (cd/m^2) to RGB values%% rgb = lum2rgb( lum, roundflag )% 16-Apr-1998 -- created (RFM)% 06-Nov-2007 -- rewritten for native 32-bit greyscale mode (RFM)% set default argumentsdefarg('roundflag',1);global ENVIRONp=ENVIRON.monitor.gamma;% check luminance rangelum=clipwarn(lum,[ p(4) p(1)+p(4) ]);% convertrgb = (255-p(2))*power((lum-p(4))/p(1),1/p(3))+p(2);if roundflag    rgb=round(rgb);endreturn