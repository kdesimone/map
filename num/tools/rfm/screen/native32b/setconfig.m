function setconfig( param, value )% SETCONFIG  Set environment configuration parameters%% setconfig( param, value )%% valid actions%     - init%     - machine%     - monitor%     - viewdistance%     - bgrgb, fgrgb%     - bglum, fglum% 29-Apr-1998 -- created (RFM)% 06-Nov-2007 -- rewritten for native32b mode (RFM)% set default argumentsdefarg('param','init');defarg('value','');% check initializationif isempty(whos('global','ENVIRON')) && strcmp(lower(param),'init')==0    warning('setconfig not initialized; initializing now');    setconfig('init');end% get environment variableglobal ENVIRON% set parametersswitch lower(param),        case 'init',        ENVIRON=[];        if exist('environ.txt','file')            setconfig('machine',getvarfromfile('environ.txt','machine'));            mname=getvarfromfile('environ.txt','defaultmonitor');            setconfig('monitor',getvarfromfile('environ.txt','m',[ 'strcmp(m.name,''' mname ''')==1' ]));            setconfig('viewdistance',getvarfromfile('environ.txt','viewdistance'));        else            warning('cannot find environ.txt; using default values');            setconfig('machine','localmachine');            m.name='localmonitor'; m.mode='native32b'; m.caldate='01-Jan-1901 00:00:00'; m.screennum=0; m.screensize=[1680 1050]; m.pixelsize=0.000300; m.framerate=60; m.gamma=[100 0 2 0];            setconfig('monitor',m);            setconfig('viewdistance',0.57);        end        setconfig('bgrgb',[ 128 128 128 ]);        setconfig('fgrgb',[ 255 255 255 ]);            case 'machine',        ENVIRON.machine=value;            case 'monitor',        if isstr(value),            ENVIRON.monitor=getvarfromfile('environ.txt','m',[ 'strcmp(m.name,''' value ''')==1' ]);        else            ENVIRON.monitor=value;        end        if isfield(ENVIRON,'viewdistance')            ENVIRON.pixelperdeg=1/atand(ENVIRON.monitor.pixelsize/ENVIRON.viewdistance);        end            case 'viewdistance',        ENVIRON.viewdistance=value;        ENVIRON.pixelperdeg=1/atand(ENVIRON.monitor.pixelsize/ENVIRON.viewdistance);            case 'bgrgb',        ENVIRON.bgrgb=value(:)';            case 'fgrgb',        ENVIRON.fgrgb=value(:)';            case 'bglum',        ENVIRON.bgrgb=repmat(lum2rgb(value),[ 1 3 ]);            case 'fglum',        ENVIRON.fgrgb=repmat(lum2rgb(value),[ 1 3 ]);            otherwise        error( sprintf('Unknown parameter ''%s''',param) );        endreturn